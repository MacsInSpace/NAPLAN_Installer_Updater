$MSIPath = "C:\ProgramData\Naplan\Temp\Naplan_Setup.msi"
$ExtractPath = "C:\Temp\Naplan_Extract"

# Ensure the extraction path exists
if (!(Test-Path $ExtractPath)) { New-Item -ItemType Directory -Path $ExtractPath -Force }

# Run MSI Extraction
Start-Process -FilePath "msiexec.exe" -ArgumentList "/a `"$MSIPath`" TARGETDIR=`"$ExtractPath`" /qn" -Wait -NoNewWindow

Write-Host "MSI Extracted to: $ExtractPath"
